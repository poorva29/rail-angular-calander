@model MiraiConsultMVC.Models.Profile

@{
    ViewBag.Title = "PatientProfile";
    Layout = "~/Views/Shared/_PatientMasterLayout.cshtml";
}
<script type="text/javascript" src="~/Content/js/utility.js"></script>
@Scripts.Render("~/bundles/jqueryval")
@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)
    {
        <div class="row-fluid patientprofile_div">
            <div class="span12 main-outter-padding">
                <div class="row-fluid">
                    <div class="span12 cust-header-name-text">
                        <h5 class="title cust-header-main-text-title"> My Profile</h5>
                    </div>
                </div>
                @if (ViewBag.message != null && (ViewBag.message == "Account has been updated successfully." || ViewBag.message == "Account has been Updated successfully and you will receive verification email shortly. Please check spam/junk incase you don't find an email in your inbox."))
                {
                 <div class="wrapper-bordered alert alert-success"  id="SuccessMessagediv" visible="true">
                    <div class="row-fluid">
                        <div class="span12">
                            <label id="lblSuccessMessage" class="success_message_color msg_font">@ViewBag.message</label>
                        </div>
                    </div>
                </div>
                }
                <div id="controlcontainer" class="wrapper-bordered cust-font-style " visible="true">
                    <div class="row-fluid">
                        @if (ViewBag.message != null && ViewBag.message == "This username is not available. Please select a different username.")
                        {
                            <div class="span12 alert alert-error" id="errorMessageDiv" visible="true">
                                <label id="lblErrorMessage" class="error_message_color msg_font">@ViewBag.message</label>
                            </div>
                        }
                    </div>
                    <div class=" " id="patinet_profile">
                        <div class="row-fluid custom-equal-padding">
                            <div class="row-fluid cust-padding-bw-row">
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label cust-font-style required ">First Name:</label>
                                        <div class="controls">
                                            @Html.TextBoxFor(m => m.FirstName, new { @class = "cust-no-border cust-lightgreen input-block-level profile-max-width min-width contact_margin", placeholder = "First Name" })<br />
                                            @Html.ValidationMessageFor(m => m.FirstName, string.Empty, new { @class = "validation-summary-errors" })
                                        </div>
                                    </div>
                                </div>
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label required  cust-font-style ">Last Name:</label>
                                        <div class="controls">
                                            @Html.TextBoxFor(m => m.LastName, new { @class = "input-block-level cust-lightgreen cust-gray profile-max-width min-width contact_margin", placeholder = "Last Name" })<br/>
                                            @Html.ValidationMessageFor(m => m.LastName, string.Empty, new { @class = "validation-summary-errors" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row-fluid cust-padding-bw-row">
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label required cust-font-style ">Email:</label>
                                        <div class="controls">
                                            @Html.TextBoxFor(m => m.Email, new { @class = "input-block-level cust-lightgreen cust-gray profile-max-width min-width contact_margin", placeholder = "Email" })<br/>
                                            @Html.ValidationMessageFor(m => m.Email, string.Empty, new { @class = "validation-summary-errors" })
                                        </div>
                                    </div>
                                </div>
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label cust-font-style">Mobile No:</label>
                                        <div class="controls">
                                            @Html.TextBoxFor(m => m.MobileNo, new { @class = "input-block-level cust-lightgreen profile-max-width min-width contact_margin", placeholder = "Mobile No", @onkeypress = "return isNumber(event,10,this);" })<br/>
                                            @Html.ValidationMessageFor(m => m.MobileNo, string.Empty, new { @class = "validation-summary-errors" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row-fluid cust-padding-bw-row">
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label cust-font-style">Date of Birth:</label>
                                        <div class="controls">
                                                <div class="input-append date" id="dob" data-date-format="dd/mm/yyyy" data-date-start-view="decade"
                                                     data-date-enddate="new Date()">
                                                    @Html.TextBoxFor(m => m.DateOfBirth, new { @class = "cust-lightgreen input-without-right-curve padding-left-to-date date_box_width txtdateOfBirth contact_margin date_box_width_patient", @style = "margin-top:0px;", placeholder = "Date Of Birth", @Value = Model.DateOfBirth == null ? null : Convert.ToDateTime(Model.DateOfBirth).ToString("dd/MM/yyyy"), @id = "txtDob" })
                                                    <span class="add-on add-on-green  icon-with-right-curve"></span><br />
                                                    @Html.ValidationMessageFor(m => m.DateOfBirth, string.Empty, new { @class = "validation-summary-errors" })
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label cust-font-style">Gender:</label>
                                        <div class="controls">
                                            @if (Model.Gender != null)
                                            {
                                                <label class="radio inline gendermargin cust-font-style">
                                                    @Html.RadioButton("Gender", "0", Model.Gender == 0, new { @class = "cust-font-style" }) Male
                                                </label>
                                                <label class="radio inline gendermargin cust-font-style">
                                                    @Html.RadioButton("Gender", "1", Model.Gender == 1, new { @class = "cust-font-style" }) Female
                                                </label>
                                            }
                                            else
                                            {
                                                <label class="radio inline cust-font-style">                                              
                                                    @Html.RadioButton("Gender", "0", true , new { @class = "cust-font-style" }) Male
                                                </label>
                                                  <label class="radio inline gendermargin cust-font-style">
                                                    @Html.RadioButton("Gender", "1", false, new { @class = "cust-font-style" }) Female
                                                </label>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row-fluid cust-padding-bw-row">
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label cust-font-style">Country:</label>
                                        <div class="controls">
                                            @if (Model.Countries != null)
                                            {
                                                ViewBag.countries = Model.Countries;
                                                @Html.DropDownListFor(m => Model.CountryId, new SelectList(ViewBag.countries, "Value", "Text", Model.CountryId), "--- Select Country---", new { @class = "input-block-level cust-lightgreen cust-gray drop-arrows max-width min-width contact_margin", id = "ddlCountry", onchange = "getStatebyCountry(this.value)" })
                                            }
                                            else
                                            {
                                                @Html.DropDownListFor(m => Model.CountryId, new SelectList(string.Empty),"--- Select Country---", new { @class = "input-block-level cust-lightgreen cust-gray drop-arrows max-width min-width contact_margin", id = "ddlCountry", onchange = "getStatebyCountry(this.value)" })
                                            }
                                        </div>
                                    </div>
                                </div>
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label cust-font-style">State:</label>
                                        <div class="controls">
                                            @if (Model.States != null)
                                            {
                                                ViewBag.states = Model.States;
                                                @Html.DropDownListFor(m => Model.StateId, new SelectList(ViewBag.states, "Value", "Text", Model.StateId), "--- Select State---", new { @class = "input-block-level  cust-lightgreen drop-arrows max-width min-width contact_margin", id = "ddlState", onchange = "getCitybyState(this.value)" })
                                            }
                                            else
                                            {
                                               @Html.DropDownListFor(m => Model.StateId, new SelectList(string.Empty), "--- Select State---", new { @class = "input-block-level  cust-lightgreen drop-arrows max-width min-width contact_margin", id = "ddlState", onchange = "getCitybyState(this.value)" })
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row-fluid cust-padding-bw-row">
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label cust-font-style">City:</label>
                                        <div class="controls">
                                            @if (Model.Cities != null)
                                            {
                                                ViewBag.cities = Model.Cities;
                                                @Html.DropDownListFor(m => Model.CityId, new SelectList(ViewBag.cities, "Value", "Text", Model.CityId), "--- Select City---", new { @class = "input-block-level cust-lightgreen drop-arrows max-width min-width contact_margin", id = "ddlCity", onchange = "getLocationbyCity(this.value)" })
                                            }
                                            else
                                            {
                                                @Html.DropDownListFor(m => Model.CityId, new SelectList(string.Empty), "--- Select City---", new { @class = "input-block-level cust-lightgreen drop-arrows max-width min-width contact_margin", id = "ddlCity", onchange = "getLocationbyCity(this.value)" })
                                            }
                                        </div>
                                    </div>
                                </div>
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label cust-font-style">Location:</label>
                                        <div class="controls">
                                            @if (Model.Locations != null)
                                            {
                                                ViewBag.locations = Model.Locations;
                                                @Html.DropDownListFor(m => Model.LocationId, new SelectList(ViewBag.locations, "Value", "Text", Model.LocationId), "--- Select Location---", new { @class = "input-block-level cust-gray drop-arrows cust-lightgreen max-width min-width contact_margin", id = "ddlLocation" })
                                            }
                                            else
                                            {
                                                @Html.DropDownListFor(m => Model.LocationId, new SelectList(string.Empty), "--- Select Location---", new { @class = "input-block-level cust-gray drop-arrows cust-lightgreen max-width min-width contact_margin", id = "ddlLocation" })
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row-fluid cust-padding-bw-row">
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label cust-font-style">Address:</label>
                                        <div class="controls">
                                            @Html.TextAreaFor(m => m.Address, new { @class = "input-block-level cust-lightgreen cust-gray profile-max-width min-width contact_margin", placeholder = "Address", rows = "2", columns = "50" })
                                        </div>
                                    </div>
                                </div>
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label cust-font-style">Pin Code:</label>
                                        <div class="controls">
                                            @Html.TextBoxFor(m => m.Pincode, new { @class = "input-block-level cust-lightgreen cust-lightgreen profile-max-width min-width contact_margin", placeholder = "Pin Code", @Value = (Model.Pincode == 0) ? "" : Model.Pincode.ToString(), @onkeypress = "return isNumber(event,6,this);", id = "txtPinCode" })<br/>
                                            @Html.ValidationMessageFor(m => m.Pincode, string.Empty, new { @class = "validation-summary-errors" })                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row-fluid cust-padding-bw-row">
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label cust-font-style">Height (in cm):</label>
                                        <div class="controls">
                                            @Html.TextBoxFor(m => m.Height, new { @class = "input-block-level cust-lightgreen cust-lightgreen profile-max-width min-width contact_margin", placeholder = "Height in cm", @Value = (Model.Height == 0) ? "" : Model.Height.ToString(), @onkeypress = "return isNumber(event,5,this);", id = "txtHeight" })<br/>
                                            @Html.ValidationMessageFor(m => m.Height, string.Empty, new { @class = "validation-summary-errors" })                                            
                                        </div>
                                    </div>
                                </div>
                                <div class="span6 span_margin">
                                    <div class="control-group controlgroup_margin">
                                        <label class="control-label cust-font-style">Weight (in kg):</label>
                                        <div class="controls">
                                            @Html.TextBoxFor(m => m.Weight, new { @class = "input-block-level cust-lightgreen cust-gray profile-max-width min-width contact_margin", placeholder = "Weight in kg", @Value = (Model.Weight == 0) ? "" : Model.Weight.ToString(), @onkeypress = "return isDecimalNumber(event,3,this);", id = "txtWeight" })<br/>
                                            @Html.ValidationMessageFor(m => m.Weight, string.Empty, new { @class = "validation-summary-errors" })                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid cust-padding-bw-row">
                        <div class="span12 btn-padding-left btn-margin-top profile-button" style="text-align:center">
                            <input type="submit" class="btn cust-button-radius cust-skyblue cust-uppercase cust-space-around cust-medium-button cust-font-style button-float btn-margin-left" id="btnUpdatePatientAccount" value="Update" onclick="return (validation());" />
                            <input type="reset" class="btn cust-button-radius cust-uppercase cust-red cust-space-around cust-medium-button cust-font-style button-float" onclick="resetAction();" value="Reset" onclick="ClearMessage()" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="span2"></div>
    }
}
<script type="text/javascript" src="../Scripts/bootstrap-datepicker.js"></script>
<script type="text/javascript" src="../Scripts/dateofbirthvalidation.js"></script>
<script type="text/javascript">
    $(function () {
        $('#dob').datepicker();
    });
    function ClearMessage() {
        document.getElementById('SuccessMessagediv').style.display = 'none';
        document.getElementById('errorMessagediv').style.display = 'none';
    }
    $("#txtDob").focusout(function () {
        var cntrl = $(this);
        if (cntrl.val().length > 0)
            isValidDateofBirth(cntrl);
    })
    function resetAction() {
        $("span.validation-summary-errors.field-validation-error").html("");
        window.location.href = '/patient-profile';
    }
    function getStatebyCountry(countryId) {
        if (countryId.length == 0)
            countryId = 0;
        $.ajax({
            type: "GET",
            url: '../Patients/poupulateStateByCountry' + '?countryId=' + countryId,
            datatype: "JSON",
            contentType: "application/json; charset=utf-8",
            success: function (returndata) {               
                $("#ddlState").empty();
                $("#ddlCity").empty();
                $("#ddlLocation").empty();
                getCitybyState(0);
                for (var i = 0; i < returndata.length; i++) {
                    $("#ddlState").append($('<option>').text(returndata[i].name).attr('value', returndata[i].stateid));
                };
            }
        });
    }
    
    function getCitybyState(stateId) {
        if (stateId.length == 0)
            stateId = 0;
        $.ajax({
            type: "GET",
            url: '../Patients/poupulateCityByState' + '?stateId=' + stateId,
            datatype: "JSON",
            contentType: "application/json; charset=utf-8",
            success: function (returndata) {
                $("#ddlCity").empty();
                $("#ddlLocation").empty();
                getLocationbyCity(0);
                for (var i = 0; i < returndata.length; i++) {
                    $("#ddlCity").append($('<option>').text(returndata[i].name).attr('value', returndata[i].cityid));
                };
            }
        });
    }

    function getLocationbyCity(cityId) {
        if (cityId.length == 0)
            cityId = 0;
        $.ajax({
            type: "GET",
            url: '../Patients/poupulateLocationByCity' + '?cityId=' + cityId,
            datatype: "JSON",
            contentType: "application/json; charset=utf-8",
            success: function (returndata) {
                $("#ddlLocation").empty();
                for (var i = 0; i < returndata.length; i++) {
                    $("#ddlLocation").append($('<option>').text(returndata[i].name).attr('value', returndata[i].locationid));
                };
            }
        });
    }

    function validation()
    {
        var msg = null;
        if (document.getElementById('FirstName') == null && document.getElementById('FirstName') == '')
        {
            alert("Please enter First Name.");
            return false;
        }
        else {
            return true;
        }
    }
    function isDecimalNumber(evt, num, txt) {
        evt = (evt) ? evt : window.event;
        var charCode = (evt.which) ? evt.which : evt.keyCode;
        var len = $(txt).val().length;
        if (charCode == 8 || charCode == 39 || charCode == 37 || charCode == 46) {
            return true;
        }
        if ((charCode > 31 && (charCode < 48 || charCode > 57) && charCode != 46) || len >= num) {
            return false;
        }
        return true;
    }

    function isNumber(evt, num, txt) {
        evt = (evt) ? evt : window.event;
        var len = $(txt).val().length;
        var charCode = (evt.which) ? evt.which : evt.keyCode;
        if (charCode == 8 || charCode == 39 || charCode == 37 || charCode == 46) {
            return true;
        }
        if ((charCode > 31 && (charCode < 48 || charCode > 57)) || len >= num) {
            return false;
        }
        return true;
    }
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-48132984-2', 'askmirai.com');
    ga('send', 'pageview');

</script>

