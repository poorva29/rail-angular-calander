@model IEnumerable<QuestionDtlModel>
    @{
        ViewBag.Title = "DoctorQuestionDetails";
        Layout = "~/Views/Shared/_PatientMasterLayout.cshtml";
    }

    <div class="row-fluid">
        <div class=" custom-central-div">
            <div class="span12">
                @if (Model != null && Model.Count() != 0)
                {
                    <div class='span12 custom-green-container'>
                        <div class='question_text'>@Model.FirstOrDefault().QuestionText</div>
                    </div>
                    <br />
                    if (@Model.FirstOrDefault().AnswerId!=null)
                    {
                        foreach(var item in Model)
                        {
                            <div class="row-fluid">
                                <div class="span1 question_detail hidden-phone">
                                    <div class="feedDocImage img">
                                        @if (!String.IsNullOrEmpty(item.DoctorImg))
                                        {
                                            <img src='@(item.DoctorImg)' alt="" />
                                        }
                                        else
                                        {
                                            <img src="../Content/image/img-na.png" />
                                        }
                                    </div>
                                </div>
                                <div class='feedDocImage img visible-phone'>
                                    @if (!String.IsNullOrEmpty(item.DoctorImg))
                                    {
                                        <img src='@(item.DoctorImg)' alt="" />
                                    }
                                    else
                                    {
                                        <img src="../Content/image/img-na.png" />
                                    }
                                </div>
                                <div class='span8'>
                                    <div class='ans_time_detail intermediate-size-padding'>Dr. @item.Doctor </div>
                                    <div class='title_text intermediate-size-padding'>
                                        @item.Title
                                    </div>
                                </div>
                                <div class="span3">
                                    <div id='@(item.AnswerId)ans'><div class="inner-count-likes pull-right" title="Thanked by patient"> @item.ThanxCount </div><div class="inner-count-endorse pull-right" title="Endorsed">@item.EndorseCount</div></div>
                                </div>
                            </div>

                            <div class='row-fluid'>
                                @if (!String.IsNullOrEmpty(item.AnswerImg))
                                {
                                    <div class='span5 offset1'>
                                        <p class='ans_text'>@item.AnswerText</p>
                                    </div>
                                    <div class='span3'>
                                        <div class='feedAnsImage img'>
                                           <img src='../feed/answerPhotos/@(item.AnswerImg)'>
                                        </div>
                                    </div>
                                } 
                                else
                                {
                                    <div class='span11 offset1'>
                                        <p class='ans_text'>@item.AnswerText</p>
                                    </div>
                                }
                            </div>
                            if (Convert.ToInt32(Session["UserId"]) != Convert.ToInt32(item.DocId))
                            {
                                <div class='row-fluid'>
                                    <div style="width:100%">
                                        <div class='span10 hidden-phone'><hr style="margin:15px" /></div>
                                        @{bool isendorse;
                                            isendorse = Convert.ToBoolean(item.IsEndorse);
                                        if (!isendorse)
                                        {
                                            if (Session["UserId"] != null && Session["UserFullName"] != null&& !String.IsNullOrEmpty(Convert.ToString(item.AnswerId)) && !String.IsNullOrEmpty(item.LastName) && !String.IsNullOrEmpty(item.MobileNo) && !String.IsNullOrEmpty(item.Email) && !String.IsNullOrEmpty(item.QuestionText) && !String.IsNullOrEmpty(Convert.ToString(item.EndorseCount)))//UserFullName is in questiontext endorsecount
                                            {
                                                //<a class='custom-link' onclick='return endorseToDoctor(" <%=  Session["UserId"] %> ","  <%=  QuestionDetails.Tables[0].Rows[i]["answerid"] %>   ",this,"  <%=  QuestionDetails.Tables[0].Rows[i]["lastname"] %>"," <%=  QuestionDetails.Tables[0].Rows[i]["mobileno"] %>  ","<%=  QuestionDetails.Tables[0].Rows[i]["Email"] %>"," <%=  Session["UserFullName"] %> ","<%=  QuestionDetails.Tables[0].Rows[i]["questiontext"] %>","<%=  QuestionDetails.Tables[0].Rows[i]["endorsecount"] %>")'><b>Want to endorse?</b></a>
                                               <a class='custom-link' onclick="return endorseToDoctor(@(Convert.ToInt32(Session["UserId"])),'@(item.AnswerId)',@("this"),' @(item.LastName)','@(item.MobileNo)','@(item.Email)','@(Session["UserFullName"])','@(item.QuestionText)','@(item.EndorseCount)')"><b>Want to endorse?</b></a>
                                            }
                                        }
                                        else
                                        {
                                            <a class="custom-green-text"><img src='../Content/image/thanks.png' />Endorsed</a>
                                        }
                                        }
                                    </div>
                                </div>
                            }
                            if (Model.LastOrDefault()!=item)
                            {
                                <hr class='hr_color' />
                            }
                        }
                    }
                    else
                    {
                        <div class="span12">No answers received</div>
                        <br />
                    }
                }
                else
                {
                    <div class="span12">No records found</div>
                    <br />

                }

                <div class="wrapper-bordered" id="SuccessMessagediv" style="display:none">
                    <div class="row-fluid">
                        <div class="span12">
                            @*<asp:Label ID="lblSuccessMessage" runat="server" Text=""></asp:Label>*@
                        </div>
                    </div>
                </div>
                <div id="answer_container" class="offset2 span7 " @*runat="server"*@ style="display:none">
                    <div class=" custom-green-container">
                        <div class="row-fluid">
                            <div class="span12">
                            </div>
                        </div>
                        <br />
                        <div class="row-fluid ">
                            <label class="pull-left span4 btn-padding-left">Title:</label>
                            <div class="pull-right span8 main-outter-padding">
                                <input type="text" class="input-block-level" id="txttitle" placeholder="Title" maxlength="50" runat="server" />
                            </div>
                        </div>
                        <br />
                        <div class="row-fluid">
                            <label class="pull-left span4 required  btn-padding-left">Answer:</label>
                            <div class="pull-right span8  main-outter-padding">
                                <div>
                                    <textarea class="input-block-level txtareaborder" maxlength="500" id="txtAnswer" onkeyup="Count(this)" placeholder="Enter Your Answer Here." clientidmode="Static" runat="server" rows="3" cols="10"></textarea>
                                    <label id="count" style="float:right">0/500</label>
                                </div>
                                @*<asp:RequiredFieldValidator ID="RequiredAnswer" runat="server" ControlToValidate="txtAnswer" ForeColor="Red"
                        ErrorMessage="Please Enter Answer." Display="Dynamic" ValidationGroup="submit"></asp:RequiredFieldValidator>*@
                            </div>
                        </div>
                        <br />
                        <div class="row-fluid">
                            <label class="pull-left span4  btn-padding-left">Upload Image:</label>
                            <div class="pull-right span8  main-outter-padding">
                                @*<asp:FileUpload MaxLength="256" class="fileupload_btn_margin" runat="server" ID="fileUploadForImage" type="file"></asp:FileUpload>*@
                                @*<asp:CustomValidator ID="CustomValidatorForImage" runat="server" ControlToValidate="fileUploadForImage"
                        Display="Dynamic" ValidationGroup="submit" OnServerValidate="ServerFileUploadValidtion"
                        ClientValidationFunction="validatePhoto" ErrorMessage="Supports only .jpg,.png,.gif,.jpeg formats. Please upload a file with either of these extensions."></asp:CustomValidator>*@
                                @*<asp:CustomValidator ID="FileUploadCustomValidator" runat="server" ControlToValidate="fileUploadForImage"
                        OnServerValidate="FileUploadCustomValidator_ServerValidate" ErrorMessage="File must be less then 10MB" Display="Dynamic" ValidationGroup="submit"></asp:CustomValidator>*@
                            </div>
                        </div>
                        <br />
                        <div class="row-fluid">
                            <div class="span6 offset4 btn-padding-left">
                                @*<asp:Button ID="btnCreateDoctorAccount" class="btn thanx" runat="server" AutoPostBack="true" OnClick="btnSubmitAnswer_Click"
                        OnClientClick="if (!Page_ClientValidate()){ this.disabled = false;} else{ this.disabled = true;}" UseSubmitBehavior="false" Text="Submit" ValidationGroup="submit"></asp:Button>*@
                                @*<asp:Button ID="btnClear" runat="server" Text="Clear" ValidationGroup="clear" class="btn" OnClick="btnClear_Click"></asp:Button>*@
                            </div>
                        </div>
                        <br />
                    </div>
                </div>
            </div>
        </div>
    </div>
<script type="text/javascript">
    $(function () {
        var refUrl = document.referrer;
        if (refUrl.indexOf("questionlist.aspx") >= 0) {
            $(".navigation li.active").removeClass("active");
            $('#liDocQuestions').addClass("active");
        }
    });
    function Count(x) {
        if (x.id == 'txtAnswer')
            document.getElementById('count').innerHTML = x.value.length + "/500";
    }

    function validatePhoto(sender, args) {
        var file = document.getElementById('<%=fileUploadForImage.ClientID%>');
        var fileName = file.value;
        var lastDot = fileName.lastIndexOf(".");
        if (fileName.length > 0) {
            var fileType = fileName.substring(lastDot, fileName.length);
            args.IsValid = (((fileType.toLowerCase() == ".jpg") || (fileType.toLowerCase() == ".png") || (fileType.toLowerCase() == ".gif") || (fileType.toLowerCase() == ".jpeg")));
        }
    }
    $(".input-block-level").keyup(function () {
        Page_ClientValidate();
    });
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-48132984-2', 'askmirai.com');
    ga('send', 'pageview');
</script>