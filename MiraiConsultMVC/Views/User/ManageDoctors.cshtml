<script src="~/Content/js/jquery.dataTables.js"></script>
<script src="~/Content/js/bootstrap-pagination.js"></script>
<div class="row-fluid div_margin_bottom">
    @*<asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
        <contenttemplate>*@
            <div class="span12 main-outter-padding">
                <div class="row-fluid">
                    <div class="span12 finddoc-title">
                        Manage Doctors
                    </div>
                </div>
                <div class="main row-fluid">
                    <div class="span12">
                        <div class="">
                            <div class="row-fluid registerDoctor">
                                <div class="row-fluid filter-div btn-padding-left">
                                    <div class="span1">
                                        <b>Filter:</b>
                                    </div>
                                    <div class="span3">
                                        <input id="ChkRegistered" name="view" type="checkbox" checked="checked" oncheckedchanged="ChkRegistered_Checked" />
                                        <label class="checkbox chk_box_inline">Registered Doctors</label>
                                    </div>
                                    <div class="span3">
                                        <input id="ChkApproved" name="view" type="checkbox"  oncheckedchanged="ChkApproved_Checked" />
                                        <label class="checkbox chk_box_inline ">Approved Doctors </label>
                                    </div>
                                    <div class="span3">
                                        <input id="ChkRejected" name="view" type="checkbox"  oncheckedchanged="ChkRejected_Checked" />
                                        <label class="checkbox chk_box_inline">Rejected Doctors </label>
                                    </div>
                                </div>
                                <div class="row-fluid div_margin_bottom">
                                    <div class="span12">
                                        <div class="table-responsive">
                                            <table cellpadding="0" cellspacing="0" border="0" class="custom-table zebra-striped"
                                                   id="Doctorlist">
                                                <thead>
                                                    <tr>
                                                        <th>
                                                            <b>Name</b>
                                                        </th>
                                                        <th>
                                                            <b>Registration Date</b>
                                                        </th>
                                                        <th>
                                                            <b>Email ID</b>
                                                        </th>
                                                        <th>
                                                            <b>Specialities</b>
                                                        </th>
                                                        <th>
                                                            <b>Mobile No.</b>
                                                        </th>
                                                        <th>
                                                            <b>Status</b>
                                                        </th>
                                                        <th class="edit_th_min_width">
                                                            <b>Edit </b>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @*<%foreach (Model.User doctor in lstdoctors)
                                                    {
                                                    string DoctorId = Convert.ToString(doctor.UserId);
                                                    string DoctorMobile = Convert.ToString(doctor.MobileNo);
                                                    string DoctorEmail = Convert.ToString(doctor.Email);
                                                    string DoctorName = Convert.ToString(doctor.LastName);
                                                    string encDoctorId = HttpUtility.UrlEncode(askmirai.Utilities.Encrypt(DoctorId));   %>
                                                    <tr>
                                                        <td style='word-wrap: break-word'>
                                                            Dr. <%=doctor.FirstName%> <%=doctor.LastName %>
                                                        </td>
                                                        <td style='word-wrap: break-word'>
                                                            <%=doctor.RegistrationDate.ToString("dd/MM/yyyy")%>
                                                        </td>
                                                        <td style='word-wrap: break-word'>
                                                            <%=doctor.Email%>
                                                        </td>
                                                        <td style='word-wrap: break-word'>
                                                            <%if (doctor.specialities.Count != 0)
                                                            {%>
                                                            <%=doctor.specialities[0].Speciality%>
                                                            <%}
                                                            else
                                                            { %>
                                                            NA
                                                            <%}%>
                                                        </td>
                                                        <td style='word-wrap: break-word'>
                                                            <%=doctor.MobileNo%>
                                                        </td>
                                                        <td>
                                                            <%if (doctor.Status == 0)
                                                            {%>
                                                            Pending
                                                            <%}
                                                            else if (doctor.Status == 1)
                                                            { %>
                                                            Registered
                                                            <%}
                                                            else if (doctor.Status == 2)
                                                            { %>
                                                            Approved
                                                            <%}
                                                            else if (doctor.Status == 3)
                                                            { %>
                                                            Rejected
                                                            <%}%>
                                                        </td>
                                                        <td class="last-row">
                                                            <%if (doctor.Status == 3)
                                                            {%>
                                                            <a title="Edit" class="anchor hand-cursor" onclick="showDoctorDetailById('<%=encDoctorId%>')"><img class="cust-icon" src="../Resources/image/edit2.png"></a>
                                                            <a title="Approve" class="hand-cursor" id="btnApproved" onclick="approveStatusByDoctorID('<%=DoctorId%>','<%=DoctorMobile%>','<%=DoctorEmail%>','<%=DoctorName%>')">
                                                                <img class="cust-icon hand-cursor" src="../Resources/image/check.png">
                                                                <%}
                                                                else if (doctor.Status == 2)
                                                                { %>
                                                                <a title="Edit" class="anchor hand-cursor" onclick="showDoctorDetailById('<%=encDoctorId%>')"><img class="cust-icon" src="../Resources/image/edit2.png"></a>
                                                                <a title="Reject" class="hand-cursor" id="btnRejected" onclick="rejectStatusByDoctorID('<%=DoctorId%>','<%=DoctorMobile%>','<%=DoctorEmail%>')">
                                                                    <img class="cust-icon" src="../Resources/image/revoke.png">
                                                                    <%}
                                                                    else if (doctor.Status == 1)
                                                                    { %>
                                                                    <a title="Edit" class="anchor hand-cursor" onclick="showDoctorDetailById('<%=encDoctorId%>')"><img class="cust-icon" src="../Resources/image/edit2.png"></a>
                                                                    <a title="Approve" class="hand-cursor" id="btnApproved1" onclick="approveStatusByDoctorID('<%=DoctorId%>','<%=DoctorMobile%>','<%=DoctorEmail%>','<%=DoctorName%>')">
                                                                        <img class="cust-icon" src="../Resources/image/check.png">
                                                                    </a>
                                                                    <a title="Reject" class="hand-cursor" id="btnRejected1" onclick="rejectStatusByDoctorID('<%=DoctorId%>','<%=DoctorMobile%>','<%=DoctorEmail%>')">
                                                                        <img class="cust-icon" src="../Resources/image/revoke.png">
                                                                        <%}
                                                                        %>
                                                        </td>
                                                    </tr>
                                                    <%  }
                                                    %>*@
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        @*</contenttemplate>
    </asp:UpdatePanel>*@
</div>

<script type="text/javascript">
    Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler);
    var responsFlag = 1;
    function onSuccess(result) {
        alert(result);
        window.location.assign(location.href);
    }
    function onFailure(error) {
        window.location.assign(location.href);
    }
    function approveStatusByDoctorID(doctorid, DoctorMobile, DoctorEmail, DoctorName) {
        if (responsFlag == 1) {
            if (confirm("Are you sure you want to approve this user?") == true) {
                document.body.style.cursor = 'wait';
                PageMethods.ApproveStatusByDoctorId(doctorid, DoctorMobile, DoctorEmail, DoctorName, onSuccess, onFailure);
                responsFlag = 0;
            }
            else {
                responsFlag = 1;
            }
        }
    }
    function rejectStatusByDoctorID(doctorid, DoctorMobile, DoctorEmail) {
        if (confirm("Are you sure you want to reject this user?") == true) {
            document.body.style.cursor = 'wait';
            PageMethods.RejectDoctorByDoctorId(doctorid, DoctorMobile, DoctorEmail, onSuccess, onFailure);
        }
    }
    function showDoctorDetailById(DoctorID) {
        window.location.href = "../profile/doctorprofile.aspx?UserId=" + DoctorID;
    }
    function EndRequestHandler() {
        initDataTable();
    }
</script>

<script type="text/javascript">

    /* Table initialisation */
    function initDataTable() {
        $('#Doctorlist').dataTable({
            "sDom": '<"row-fluid"<"span6"l><"span6"f>r>t<"row-fluid"<"span5"i><"span7"p>>',
            "sPaginationType": "bootstrap",
            "bStateSave": false,
            "bDestroy": true,
            "oLanguage": {
                "sLengthMenu": "_MENU_ records per page"
            },
            // Setup for responsive datatables helper.
            bAutoWidth: false
        });
    }
    $(document).ready(function () {
        $(".navigation li.active").removeClass("active");
        $('#liManageDoctor').addClass("active");
        initDataTable();
    });

    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-48132984-2', 'askmirai.com');
    ga('send', 'pageview');
</script>

